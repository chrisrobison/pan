<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PAN Demo Suite · 09 Schema Form</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/grail.css">
</head>
<body>
  <pan-bus></pan-bus>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <span class="dot"></span>
        <span>PAN Demo Suite</span>
      </div>
      <nav class="nav-content">
        <a class="nav-item" href="./01-hello.html"><span>Hello Counter</span><span class="hint">01</span></a>
        <a class="nav-item" href="./02-todos-and-inspector.html"><span>Todos + Inspector</span><span class="hint">02</span></a>
        <a class="nav-item" href="./03-broadcastchannel.html"><span>Cross-tab Sync</span><span class="hint">03</span></a>
        <a class="nav-item" href="./04-react-wrapper.html"><span>React Wrapper</span><span class="hint">04</span></a>
        <a class="nav-item" href="./05-lit-wrapper.html"><span>Lit Wrapper</span><span class="hint">05</span></a>
        <a class="nav-item" href="./06-crud.html"><span>CRUD (Mock)</span><span class="hint">06</span></a>
        <a class="nav-item" href="./07-rest-connector.html"><span>REST Connector</span><span class="hint">07</span></a>
        <a class="nav-item" href="./08-workers.html"><span>Workers</span><span class="hint">08</span></a>
        <a class="nav-item active" aria-current="page" href="./09-schema-form.html"><span>Schema Form</span><span class="hint">09</span></a>
      </nav>
      <div class="sidebar-footer">
        Define your domain via JSON Schema and render dynamic forms with live PAN state.
      </div>
    </aside>

    <main class="main-region">
      <header class="main-header">
        <h1>Schema‑Driven Form</h1>
        <p>
          <code>pan-schema</code> publishes a JSON Schema as retained state. <code>pan-schema-form</code> renders inputs,
          validates locally, and saves via usual PAN CRUD topics.
        </p>
        <div class="badge-row">
          <span class="badge">topics: <code>users.*</code></span>
          <span class="badge">retained schema</span>
          <span class="badge">request / reply</span>
        </div>
      </header>

      <section class="content-area">
        <div class="split-vertical">
          <section class="panel">
            <div class="panel-header">
              <div>
                <h2>Users</h2>
                <div class="subtitle">Schema‑driven form + mock provider.</div>
              </div>
            </div>
            <div class="panel-body">
              <div class="detail-grid">
                <pan-data-table resource="users" columns="id,name,email,active"></pan-data-table>
                <pan-schema-form resource="users" key="id"></pan-schema-form>
              </div>
            </div>
          </section>

          <section class="panel">
            <div class="panel-header">
              <div>
                <h2>Traffic</h2>
                <div class="subtitle">Observe schema state, list state, and item traffic.</div>
              </div>
            </div>
            <div class="panel-body">
              <pan-inspector></pan-inspector>
            </div>
          </section>
        </div>
      </section>
    </main>
  </div>

  <pan-schema resource="users">
    <script type="application/json">{
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "User",
      "type": "object",
      "required": ["name","email"],
      "properties": {
        "id": { "type": "string", "title": "ID" },
        "name": { "type": "string", "title": "Name", "minLength": 1 },
        "email": { "type": "string", "title": "Email", "format": "email" },
        "active": { "type": "boolean", "title": "Active" },
        "bio": { "type": "string", "title":"Bio", "maxLength": 500, "format":"multiline" }
      },
      "ui:order": ["name","email","active","bio"]
    }</script>
  </pan-schema>

  <pan-data-provider resource="users" persist="localStorage">
    <script type="application/json">[
      {"id":"u1","name":"Ada Lovelace","email":"ada@example.com","active":true},
      {"id":"u2","name":"Grace Hopper","email":"grace@example.com","active":false},
      {"id":"u3","name":"Alan Turing","email":"alan@example.com","active":true}
    ]</script>
  </pan-data-provider>

  <script type="module">
    import '../dist/pan-bus.js';
    import '../dist/pan-client.js';
    import '../dist/pan-inspector.js';
    import '../dist/pan-data-provider-mock.js';
    import '../dist/pan-data-table.js';
    import '../dist/pan-schema.js';
    import '../dist/pan-schema-form.js';
  </script>
</body>
</html>

