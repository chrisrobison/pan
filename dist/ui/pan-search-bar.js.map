{
  "version": 3,
  "sources": ["../../src/ui/pan-search-bar.mjs"],
  "sourcesContent": ["// <pan-search-bar> \u2014 Search input with filters and PAN topic integration\n// Attributes:\n//   - placeholder: Input placeholder text\n//   - topic: Topic prefix for events\n//   - debounce: Debounce delay in ms (default: 300)\n//   - filters: JSON array of filter options [{label, value, icon?}]\n//   - show-filters: Show filter dropdown (default: true if filters provided)\n//\n// Topics:\n//   - Publishes: {topic}.search { query, filter }\n//   - Publishes: {topic}.clear\n//   - Subscribes: {topic}.set { query?, filter? }\n\nimport { PanClient } from './pan-client.mjs';\n\nexport class PanSearchBar extends HTMLElement {\n  static get observedAttributes() {\n    return ['placeholder', 'topic', 'debounce', 'filters', 'show-filters'];\n  }\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this.pc = new PanClient(this);\n    this.debounceTimer = null;\n    this.currentQuery = '';\n    this.currentFilter = null;\n  }\n\n  connectedCallback() {\n    this.render();\n    this.setupTopics();\n    this.setupEvents();\n  }\n\n  disconnectedCallback() {\n    if (this.debounceTimer) clearTimeout(this.debounceTimer);\n  }\n\n  attributeChangedCallback() {\n    if (this.isConnected) this.render();\n  }\n\n  get placeholder() { return this.getAttribute('placeholder') || 'Search...'; }\n  get topic() { return this.getAttribute('topic') || 'search'; }\n  get debounce() { return parseInt(this.getAttribute('debounce')) || 300; }\n  get filters() {\n    const attr = this.getAttribute('filters');\n    if (!attr) return [];\n    try {\n      return JSON.parse(attr);\n    } catch {\n      return [];\n    }\n  }\n  get showFilters() {\n    const attr = this.getAttribute('show-filters');\n    if (attr === 'false') return false;\n    return this.filters.length > 0;\n  }\n\n  setupTopics() {\n    this.pc.subscribe(`${this.topic}.set`, (msg) => {\n      const { query, filter } = msg.data;\n      const input = this.shadowRoot.querySelector('.search-input');\n\n      if (typeof query === 'string') {\n        this.currentQuery = query;\n        if (input) input.value = query;\n      }\n\n      if (filter !== undefined) {\n        this.currentFilter = filter;\n        this.updateFilterButton();\n      }\n    });\n  }\n\n  setupEvents() {\n    const input = this.shadowRoot.querySelector('.search-input');\n    const clearBtn = this.shadowRoot.querySelector('.clear-btn');\n    const filterBtn = this.shadowRoot.querySelector('.filter-btn');\n    const filterDropdown = this.shadowRoot.querySelector('.filter-dropdown');\n\n    if (input) {\n      input.addEventListener('input', (e) => {\n        this.currentQuery = e.target.value;\n        this.debouncedSearch();\n\n        // Show/hide clear button\n        if (clearBtn) {\n          clearBtn.style.display = this.currentQuery ? 'flex' : 'none';\n        }\n      });\n\n      input.addEventListener('keypress', (e) => {\n        if (e.key === 'Enter') {\n          this.search();\n        }\n      });\n    }\n\n    if (clearBtn) {\n      clearBtn.addEventListener('click', () => {\n        this.clear();\n      });\n    }\n\n    if (filterBtn && filterDropdown) {\n      filterBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        filterDropdown.classList.toggle('active');\n      });\n\n      // Close dropdown on outside click\n      document.addEventListener('click', () => {\n        filterDropdown.classList.remove('active');\n      });\n\n      filterDropdown.addEventListener('click', (e) => {\n        e.stopPropagation();\n        const item = e.target.closest('[data-value]');\n        if (item) {\n          this.currentFilter = item.dataset.value;\n          this.updateFilterButton();\n          filterDropdown.classList.remove('active');\n          this.search();\n        }\n      });\n    }\n  }\n\n  debouncedSearch() {\n    if (this.debounceTimer) clearTimeout(this.debounceTimer);\n    this.debounceTimer = setTimeout(() => this.search(), this.debounce);\n  }\n\n  search() {\n    this.pc.publish({\n      topic: `${this.topic}.search`,\n      data: {\n        query: this.currentQuery,\n        filter: this.currentFilter\n      }\n    });\n  }\n\n  clear() {\n    const input = this.shadowRoot.querySelector('.search-input');\n    if (input) input.value = '';\n    this.currentQuery = '';\n    this.currentFilter = null;\n\n    this.pc.publish({\n      topic: `${this.topic}.clear`,\n      data: {}\n    });\n\n    this.search();\n  }\n\n  updateFilterButton() {\n    const filterBtn = this.shadowRoot.querySelector('.filter-btn');\n    if (!filterBtn) return;\n\n    const selectedFilter = this.filters.find(f => f.value === this.currentFilter);\n    if (selectedFilter) {\n      filterBtn.textContent = `${selectedFilter.icon || '\uD83D\uDD3D'} ${selectedFilter.label}`;\n      filterBtn.classList.add('active');\n    } else {\n      filterBtn.textContent = '\uD83D\uDD3D Filter';\n      filterBtn.classList.remove('active');\n    }\n  }\n\n  render() {\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n        }\n\n        .search-bar {\n          display: flex;\n          gap: 0.5rem;\n          align-items: stretch;\n        }\n\n        .search-input-wrapper {\n          flex: 1;\n          position: relative;\n          display: flex;\n          align-items: center;\n        }\n\n        .search-icon {\n          position: absolute;\n          left: 1rem;\n          color: var(--search-icon-color, #94a3b8);\n          pointer-events: none;\n        }\n\n        .search-input {\n          width: 100%;\n          padding: 0.75rem 3rem 0.75rem 2.75rem;\n          border: 1px solid var(--search-border, #e2e8f0);\n          border-radius: 0.5rem;\n          font-family: inherit;\n          font-size: 0.95rem;\n          background: var(--search-bg, #ffffff);\n          color: var(--search-color, #1e293b);\n          transition: all 0.2s;\n        }\n\n        .search-input:focus {\n          outline: none;\n          border-color: var(--search-focus-border, #6366f1);\n          box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n        }\n\n        .clear-btn {\n          position: absolute;\n          right: 0.75rem;\n          display: none;\n          align-items: center;\n          justify-content: center;\n          width: 1.5rem;\n          height: 1.5rem;\n          border: none;\n          background: var(--search-clear-bg, #e2e8f0);\n          color: var(--search-clear-color, #64748b);\n          border-radius: 50%;\n          cursor: pointer;\n          font-size: 0.875rem;\n          transition: all 0.2s;\n        }\n\n        .clear-btn:hover {\n          background: var(--search-clear-hover-bg, #cbd5e1);\n        }\n\n        .filter-container {\n          position: relative;\n        }\n\n        .filter-btn {\n          display: flex;\n          align-items: center;\n          gap: 0.5rem;\n          padding: 0.75rem 1rem;\n          border: 1px solid var(--search-border, #e2e8f0);\n          border-radius: 0.5rem;\n          background: var(--search-bg, #ffffff);\n          color: var(--search-color, #64748b);\n          cursor: pointer;\n          font-family: inherit;\n          font-size: 0.95rem;\n          white-space: nowrap;\n          transition: all 0.2s;\n        }\n\n        .filter-btn:hover {\n          background: var(--search-hover-bg, #f8fafc);\n        }\n\n        .filter-btn.active {\n          border-color: var(--search-active-border, #6366f1);\n          color: var(--search-active-color, #6366f1);\n        }\n\n        .filter-dropdown {\n          position: absolute;\n          top: calc(100% + 0.5rem);\n          right: 0;\n          min-width: 200px;\n          background: var(--search-dropdown-bg, #ffffff);\n          border: 1px solid var(--search-dropdown-border, #e2e8f0);\n          border-radius: 0.5rem;\n          box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n          z-index: 100;\n          opacity: 0;\n          visibility: hidden;\n          transform: translateY(-10px);\n          transition: all 0.2s;\n          padding: 0.5rem 0;\n        }\n\n        .filter-dropdown.active {\n          opacity: 1;\n          visibility: visible;\n          transform: translateY(0);\n        }\n\n        .filter-item {\n          display: flex;\n          align-items: center;\n          gap: 0.75rem;\n          padding: 0.625rem 1rem;\n          cursor: pointer;\n          color: var(--search-dropdown-color, #334155);\n          font-size: 0.95rem;\n          transition: all 0.15s;\n        }\n\n        .filter-item:hover {\n          background: var(--search-dropdown-hover-bg, #f1f5f9);\n        }\n      </style>\n\n      <div class=\"search-bar\">\n        <div class=\"search-input-wrapper\">\n          <span class=\"search-icon\">\uD83D\uDD0D</span>\n          <input\n            type=\"text\"\n            class=\"search-input\"\n            placeholder=\"${this.placeholder}\"\n            value=\"${this.currentQuery}\"\n          >\n          <button class=\"clear-btn\" title=\"Clear\">\u00D7</button>\n        </div>\n\n        ${this.showFilters ? `\n          <div class=\"filter-container\">\n            <button class=\"filter-btn\">\uD83D\uDD3D Filter</button>\n            <div class=\"filter-dropdown\">\n              <div class=\"filter-item\" data-value=\"\">All</div>\n              ${this.filters.map(filter => `\n                <div class=\"filter-item\" data-value=\"${filter.value}\">\n                  ${filter.icon || ''} ${filter.label}\n                </div>\n              `).join('')}\n            </div>\n          </div>\n        ` : ''}\n      </div>\n    `;\n\n    // Re-setup events after render\n    if (this.isConnected) {\n      setTimeout(() => this.setupEvents(), 0);\n    }\n  }\n}\n\ncustomElements.define('pan-search-bar', PanSearchBar);\nexport default PanSearchBar;\n"],
  "mappings": "AAaA,SAAS,iBAAiB;AAEnB,MAAM,qBAAqB,YAAY;AAAA,EAC5C,WAAW,qBAAqB;AAC9B,WAAO,CAAC,eAAe,SAAS,YAAY,WAAW,cAAc;AAAA,EACvE;AAAA,EAEA,cAAc;AACZ,UAAM;AACN,SAAK,aAAa,EAAE,MAAM,OAAO,CAAC;AAClC,SAAK,KAAK,IAAI,UAAU,IAAI;AAC5B,SAAK,gBAAgB;AACrB,SAAK,eAAe;AACpB,SAAK,gBAAgB;AAAA,EACvB;AAAA,EAEA,oBAAoB;AAClB,SAAK,OAAO;AACZ,SAAK,YAAY;AACjB,SAAK,YAAY;AAAA,EACnB;AAAA,EAEA,uBAAuB;AACrB,QAAI,KAAK,cAAe,cAAa,KAAK,aAAa;AAAA,EACzD;AAAA,EAEA,2BAA2B;AACzB,QAAI,KAAK,YAAa,MAAK,OAAO;AAAA,EACpC;AAAA,EAEA,IAAI,cAAc;AAAE,WAAO,KAAK,aAAa,aAAa,KAAK;AAAA,EAAa;AAAA,EAC5E,IAAI,QAAQ;AAAE,WAAO,KAAK,aAAa,OAAO,KAAK;AAAA,EAAU;AAAA,EAC7D,IAAI,WAAW;AAAE,WAAO,SAAS,KAAK,aAAa,UAAU,CAAC,KAAK;AAAA,EAAK;AAAA,EACxE,IAAI,UAAU;AACZ,UAAM,OAAO,KAAK,aAAa,SAAS;AACxC,QAAI,CAAC,KAAM,QAAO,CAAC;AACnB,QAAI;AACF,aAAO,KAAK,MAAM,IAAI;AAAA,IACxB,QAAQ;AACN,aAAO,CAAC;AAAA,IACV;AAAA,EACF;AAAA,EACA,IAAI,cAAc;AAChB,UAAM,OAAO,KAAK,aAAa,cAAc;AAC7C,QAAI,SAAS,QAAS,QAAO;AAC7B,WAAO,KAAK,QAAQ,SAAS;AAAA,EAC/B;AAAA,EAEA,cAAc;AACZ,SAAK,GAAG,UAAU,GAAG,KAAK,KAAK,QAAQ,CAAC,QAAQ;AAC9C,YAAM,EAAE,OAAO,OAAO,IAAI,IAAI;AAC9B,YAAM,QAAQ,KAAK,WAAW,cAAc,eAAe;AAE3D,UAAI,OAAO,UAAU,UAAU;AAC7B,aAAK,eAAe;AACpB,YAAI,MAAO,OAAM,QAAQ;AAAA,MAC3B;AAEA,UAAI,WAAW,QAAW;AACxB,aAAK,gBAAgB;AACrB,aAAK,mBAAmB;AAAA,MAC1B;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,cAAc;AACZ,UAAM,QAAQ,KAAK,WAAW,cAAc,eAAe;AAC3D,UAAM,WAAW,KAAK,WAAW,cAAc,YAAY;AAC3D,UAAM,YAAY,KAAK,WAAW,cAAc,aAAa;AAC7D,UAAM,iBAAiB,KAAK,WAAW,cAAc,kBAAkB;AAEvE,QAAI,OAAO;AACT,YAAM,iBAAiB,SAAS,CAAC,MAAM;AACrC,aAAK,eAAe,EAAE,OAAO;AAC7B,aAAK,gBAAgB;AAGrB,YAAI,UAAU;AACZ,mBAAS,MAAM,UAAU,KAAK,eAAe,SAAS;AAAA,QACxD;AAAA,MACF,CAAC;AAED,YAAM,iBAAiB,YAAY,CAAC,MAAM;AACxC,YAAI,EAAE,QAAQ,SAAS;AACrB,eAAK,OAAO;AAAA,QACd;AAAA,MACF,CAAC;AAAA,IACH;AAEA,QAAI,UAAU;AACZ,eAAS,iBAAiB,SAAS,MAAM;AACvC,aAAK,MAAM;AAAA,MACb,CAAC;AAAA,IACH;AAEA,QAAI,aAAa,gBAAgB;AAC/B,gBAAU,iBAAiB,SAAS,CAAC,MAAM;AACzC,UAAE,gBAAgB;AAClB,uBAAe,UAAU,OAAO,QAAQ;AAAA,MAC1C,CAAC;AAGD,eAAS,iBAAiB,SAAS,MAAM;AACvC,uBAAe,UAAU,OAAO,QAAQ;AAAA,MAC1C,CAAC;AAED,qBAAe,iBAAiB,SAAS,CAAC,MAAM;AAC9C,UAAE,gBAAgB;AAClB,cAAM,OAAO,EAAE,OAAO,QAAQ,cAAc;AAC5C,YAAI,MAAM;AACR,eAAK,gBAAgB,KAAK,QAAQ;AAClC,eAAK,mBAAmB;AACxB,yBAAe,UAAU,OAAO,QAAQ;AACxC,eAAK,OAAO;AAAA,QACd;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EAEA,kBAAkB;AAChB,QAAI,KAAK,cAAe,cAAa,KAAK,aAAa;AACvD,SAAK,gBAAgB,WAAW,MAAM,KAAK,OAAO,GAAG,KAAK,QAAQ;AAAA,EACpE;AAAA,EAEA,SAAS;AACP,SAAK,GAAG,QAAQ;AAAA,MACd,OAAO,GAAG,KAAK,KAAK;AAAA,MACpB,MAAM;AAAA,QACJ,OAAO,KAAK;AAAA,QACZ,QAAQ,KAAK;AAAA,MACf;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,QAAQ;AACN,UAAM,QAAQ,KAAK,WAAW,cAAc,eAAe;AAC3D,QAAI,MAAO,OAAM,QAAQ;AACzB,SAAK,eAAe;AACpB,SAAK,gBAAgB;AAErB,SAAK,GAAG,QAAQ;AAAA,MACd,OAAO,GAAG,KAAK,KAAK;AAAA,MACpB,MAAM,CAAC;AAAA,IACT,CAAC;AAED,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,qBAAqB;AACnB,UAAM,YAAY,KAAK,WAAW,cAAc,aAAa;AAC7D,QAAI,CAAC,UAAW;AAEhB,UAAM,iBAAiB,KAAK,QAAQ,KAAK,OAAK,EAAE,UAAU,KAAK,aAAa;AAC5E,QAAI,gBAAgB;AAClB,gBAAU,cAAc,GAAG,eAAe,QAAQ,WAAI,IAAI,eAAe,KAAK;AAC9E,gBAAU,UAAU,IAAI,QAAQ;AAAA,IAClC,OAAO;AACL,gBAAU,cAAc;AACxB,gBAAU,UAAU,OAAO,QAAQ;AAAA,IACrC;AAAA,EACF;AAAA,EAEA,SAAS;AACP,SAAK,WAAW,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BA2IL,KAAK,WAAW;AAAA,qBACtB,KAAK,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,UAK5B,KAAK,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKb,KAAK,QAAQ,IAAI,YAAU;AAAA,uDACY,OAAO,KAAK;AAAA,oBAC/C,OAAO,QAAQ,EAAE,IAAI,OAAO,KAAK;AAAA;AAAA,eAEtC,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA,YAGb,EAAE;AAAA;AAAA;AAKV,QAAI,KAAK,aAAa;AACpB,iBAAW,MAAM,KAAK,YAAY,GAAG,CAAC;AAAA,IACxC;AAAA,EACF;AACF;AAEA,eAAe,OAAO,kBAAkB,YAAY;AACpD,IAAO,yBAAQ;",
  "names": []
}
